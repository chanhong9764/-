SELECT YEAR(SALES_DATE) as YEAR, MONTH(SALES_DATE) as MONTH, GENDER, count(DISTINCT USER_ID) from USER_INFO JOIN ONLINE_SALE USING (USER_ID) where GENDER IS NOT NULL group by YEAR, MONTH, GENDER